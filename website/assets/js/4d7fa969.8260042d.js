"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[105],{8908:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>s,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"troubleshooting","title":"Troubleshooting","description":"Filtering Vulnerabilities","source":"@site/versioned_docs/version-v0.5.x/troubleshooting.md","sourceDirName":".","slug":"/troubleshooting","permalink":"/copacetic/website/v0.5.x/troubleshooting","draft":false,"unlisted":false,"tags":[],"version":"v0.5.x","frontMatter":{"title":"Troubleshooting"},"sidebar":"sidebar","previous":{"title":"Output","permalink":"/copacetic/website/v0.5.x/output"},"next":{"title":"Design","permalink":"/copacetic/website/v0.5.x/design"}}');var r=i(4848),o=i(8453);const l={title:"Troubleshooting"},a=void 0,s={},c=[{value:"Filtering Vulnerabilities",id:"filtering-vulnerabilities",level:2},{value:"Rego Policy",id:"rego-policy",level:3},{value:"Ignore File",id:"ignore-file",level:3}];function g(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"filtering-vulnerabilities",children:"Filtering Vulnerabilities"}),"\n",(0,r.jsx)(n.p,{children:"You might want to filter/ignore some of the vulnerabilities while patching. To do so, you need to first filter those undesired vulnerabilities from your scanner output."}),"\n",(0,r.jsx)(n.p,{children:"For Trivy, vulnerabilities can be filtered by the following 2 ways:"}),"\n",(0,r.jsx)(n.h3,{id:"rego-policy",children:"Rego Policy"}),"\n",(0,r.jsx)(n.p,{children:"An example rego file which demonstrates how to ignore certain Vulnerability IDs or Package Names:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'$ cat trivy_ignore.rego\n\npackage trivy\n\nimport data.lib.trivy\n\ndefault ignore = false\n\n\n# Ignore the following Vulnerability IDs\nignore_vulnerability_ids := {\n   "CVE-2018-14618"\n}\n# Ignore the following Package Names\nignore_pkgs := {"bash", "vim"}\n\n\n# For ignoring vulnID\nignore {\n   input.VulnerabilityID == ignore_vulnerability_ids[_]\n}\n# For ignoring pkgName\nignore {\n\tinput.PkgName == ignore_pkgs[_]\n}\n\n'})}),"\n",(0,r.jsxs)(n.p,{children:["After adding the above rego file, run the image scan with the ",(0,r.jsx)(n.code,{children:"--ignore-policy"})," flag followed by the file name to ignore them while scanning:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"trivy image --ignore-policy trivy_ignore.rego ruby:2.4.0\n"})}),"\n",(0,r.jsx)(n.p,{children:'In the above example, the vulnerability "CVE-2018-14618"  and the packages "bash" & "vim" are ignored while scanning, and hence patching the image.'}),"\n",(0,r.jsx)(n.h3,{id:"ignore-file",children:"Ignore File"}),"\n",(0,r.jsxs)(n.p,{children:["Use a ",(0,r.jsx)(n.code,{children:".trivyignore"})," file to list all the vulnerabilities you want to ignore."]}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"$ cat .trivyignore\n\n# Accept the risk\nCVE-2018-14618\n"})}),"\n",(0,r.jsx)(n.p,{children:"In the above example, the vulnerability CVE-2018-14618 is ignored while scanning, and hence while patching the image."}),"\n",(0,r.jsxs)(n.p,{children:["For a more detailed explanation on how to ignore certain vulnerabilities with Trivy, please refer to the official documentation ",(0,r.jsx)(n.a,{href:"https://aquasecurity.github.io/trivy/v0.44/docs/configuration/filtering/",children:"here"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(g,{...e})}):g(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var t=i(6540);const r={},o=t.createContext(r);function l(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);